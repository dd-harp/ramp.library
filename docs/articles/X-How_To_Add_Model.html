<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Developing XH Modules • ramp.library</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Developing XH Modules">
<meta property="og:description" content="ramp.library">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.library</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Human / Host
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Malaria-Overview.html">Malaria Overview</a>
    </li>
    <li>
      <a href="../articles/Compartmental-Models.html">Compartmental Models</a>
    </li>
    <li>
      <a href="../articles/X-How_To_Add_Model.html">How to add a new X model</a>
    </li>
    <li>
      <a href="../articles/human_sip.html">SIP xde model</a>
    </li>
    <li>
      <a href="../articles/human_seis.html">SEIS model</a>
    </li>
    <li>
      <a href="../articles/X-garki.html">The Garki Model</a>
    </li>
    <li>
      <a href="../articles/X-xde-workhorse.html">Workhorse</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Adult
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MY-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/MY-How_To_Add_Model.html">How to add a new MY model</a>
    </li>
    <li>
      <a href="../articles/MY-macdonald.html">Macdonald's Model</a>
    </li>
    <li>
      <a href="../articles/MY-xde-RMG.html">A Behavioral State Model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Aquatic
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/L-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/L-How_To_Add_Model.html">How to add a new L model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.library/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Developing XH Modules</h1>
            <h3 data-toc-skip class="subtitle">Human/Vertebrate Host
Infection Dynamics</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/HEAD/vignettes/X-How_To_Add_Model.Rmd" class="external-link"><code>vignettes/X-How_To_Add_Model.Rmd</code></a></small>
      <div class="hidden name"><code>X-How_To_Add_Model.Rmd</code></div>

    </div>

    
    
<p>This vignette discusses how to add a new <strong>XH</strong> module
to <a href="https://github.com/dd-harp/ramp.library" class="external-link"><code>ramp.library</code></a>.
As background, we strongly recommend reading the
<strong><code>ramp.xds</code></strong> vignette about the <a href="https://dd-harp.github.io/ramp.xds/articles/XH-interface.html" class="external-link"><strong>XH</strong>
Interface.</a></p>
<p>Each <strong>XH</strong> module implements a unique model family
describing human/host infection dynamics and immunity that can be used
by <a href="https://github.com/dd-harp/ramp.xds" class="external-link"><code>ramp.xds</code></a>.
Before writing a new module, please check and see if the model family is
already part of the SimBA library.</p>
<p>If you need help, please contact <a href="mailto:smitdave@gmail.com">Professor David L Smith</a></p>
<hr>
<p>We have written this vignette to produce a new template file using
<code>knitr::purl.</code> The template can be modified to build a new
<strong>XH</strong> module.</p>
<p>Do this:</p>
<ol style="list-style-type: decimal">
<li><p>Download the markdown file that created this document <a href="https://github.com/dd-harp/ramp.library/blob/main/vignettes/X-How_To_Add_Model.Rmd" class="external-link">“X-How_To_Add_Model.Rmd.”</a></p></li>
<li><p>Set your working directory to the location of the downloaded copy
of “X-How_To_Add_Model.Rmd”</p></li>
<li><p>Execute these commands:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit.html" class="external-link">purl</a></span><span class="op">(</span><span class="st">"X-How_To_Add_Model.Rmd"</span>, </span>
<span>            output <span class="op">=</span> <span class="st">"XHmodule-newXname.R"</span>, </span>
<span>            documentation <span class="op">=</span> <span class="fl">0</span>, </span>
<span>            quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p>You should see a new file called <code>XHmodule-newXname.R</code>
in the working directory. You can now move and rename it.</p></li>
<li><p>Open the file and do a global search for <code>newXname</code>
and replace it with the a short string that will define the model as its
<code>Xname.</code></p></li>
<li><p>Edit the functions following the directions below.</p></li>
</ol>
<div class="section level2">
<h2 id="style-guide">Style Guide<a class="anchor" aria-label="anchor" href="#style-guide"></a>
</h2>
<p>We recommend that new models conform to a set of style
guidelines:</p>
<ul>
<li><p>All the names of the variables by name using the indices attached
to <code>XH_obj</code></p></li>
<li><p>All documentation is written in <code>roxygen2</code></p></li>
<li><p>Functions should use <code>with(*,{...})</code> to make the code
easier to read.</p></li>
<li><p>A vignette should accompany each model, including citations to
the relevant publications, and proposed tests of the code.</p></li>
<li><p>The functions should easy to relate to the equations defining a
model, following notation defined in an accompanying vignette.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="dynamics">Dynamics<a class="anchor" aria-label="anchor" href="#dynamics"></a>
</h2>
<div class="section level3">
<h3 id="dxhdt">dXHdt<a class="anchor" aria-label="anchor" href="#dxhdt"></a>
</h3>
<p>The sections that need to be modified are marked
<code># Change this</code></p>
<ul>
<li><p>Replace <code>X1</code> with the name of your first variable, and
replace <code>F_1</code> with the formula that computes the derivatives.
Do the same with <code>X2</code> and add lines for each
variable.</p></li>
<li><p>Modify <code>derivs = c(dH, dX1, dX2,...)</code> to return the
LHS of the derivative equations you just wrote.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Compute the derivatives for parasite infection dynamics in human population strata </span></span>
<span><span class="co">#' @description Implements [dXHdt] for the newXname model</span></span>
<span><span class="co">#' @inheritParams ramp.xds::dXHdt</span></span>
<span><span class="co">#' @return a [numeric] vector</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">dXHdt.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># do not change this</span></span>
<span>  <span class="va">foi</span> <span class="op">&lt;-</span> <span class="va">xds_obj</span><span class="op">$</span><span class="va">terms</span><span class="op">$</span><span class="va">FoI</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># do not change this</span></span>
<span>  <span class="co"># attach the variables by name </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/get_XH_vars.html" class="external-link">get_XH_vars</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span>,<span class="op">{</span></span>
<span>    <span class="co"># do not change this</span></span>
<span>    <span class="co"># attach the parameters by name </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="op">{</span></span>
<span>      <span class="co"># Do not change this </span></span>
<span>      <span class="va">dH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/Births.html" class="external-link">Births</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">H</span>, <span class="va">births</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H</span></span>
<span>      <span class="co"># Change this</span></span>
<span>      <span class="va">dX1</span> <span class="op">&lt;-</span> <span class="fu">F_1</span><span class="op">(</span><span class="va">foi</span>, <span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X1</span> </span>
<span>      <span class="va">dX2</span> <span class="op">&lt;-</span> <span class="fu">F_2</span><span class="op">(</span><span class="va">foi</span>, <span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X2</span> </span>
<span>      <span class="va">...</span> </span>
<span>      </span>
<span>      <span class="co"># Change this </span></span>
<span>      <span class="va">derivs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dH</span>, <span class="va">dX1</span>, <span class="va">dX2</span>, <span class="va">...</span><span class="op">)</span> </span>
<span>      </span>
<span>      <span class="co"># return the derivatives </span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">derivs</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="update_xht">Update_XHt<a class="anchor" aria-label="anchor" href="#update_xht"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Compute the derivatives for parasite infection dynamics in human population strata </span></span>
<span><span class="co">#' @description Implements [UpdateXHt] for the newXname model</span></span>
<span><span class="co">#' @inheritParams ramp.xds::UpdateXHt</span></span>
<span><span class="co">#' @return a [numeric] vector</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">Update_MYt.newXname</span><span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ar</span> <span class="op">=</span> <span class="va">xds_obj</span><span class="op">$</span><span class="va">terms</span><span class="op">$</span><span class="va">AR</span><span class="op">[[</span><span class="va">s</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>   <span class="co"># do not change this</span></span>
<span>  <span class="co"># attach the variables by name </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/get_XH_vars.html" class="external-link">get_XH_vars</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span>,<span class="op">{</span></span>
<span>    <span class="co"># do not change this</span></span>
<span>    <span class="co"># attach the parameters by name </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="op">{</span></span>
<span>      <span class="co"># Do not change this </span></span>
<span>      <span class="va">Ht</span> <span class="op">&lt;-</span> <span class="va">H</span> <span class="op">+</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/Births.html" class="external-link">Births</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">H</span>, <span class="va">births</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">H</span></span>
<span>      <span class="co"># Change this</span></span>
<span>      <span class="va">X1t</span> <span class="op">&lt;-</span> <span class="va">X1</span> <span class="op">+</span> <span class="fu">F_1</span><span class="op">(</span><span class="va">foi</span>, <span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X1</span> </span>
<span>      <span class="va">X2t</span> <span class="op">&lt;-</span> <span class="va">X2</span> <span class="op">+</span> <span class="fu">F_2</span><span class="op">(</span><span class="va">foi</span>, <span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="va">D_matrix</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X2</span> </span>
<span>      <span class="va">...</span> </span>
<span>      </span>
<span>      <span class="co"># Change this </span></span>
<span>      <span class="va">states</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Ht</span>, <span class="va">X1t</span>, <span class="va">X2t</span>, <span class="va">...</span><span class="op">)</span> </span>
<span>      </span>
<span>      <span class="co"># return the derivatives </span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="xh-model-object">XH Model Object<a class="anchor" aria-label="anchor" href="#xh-model-object"></a>
</h2>
<div class="section level3">
<h3 id="make_xh_obj">make_XH_obj<a class="anchor" aria-label="anchor" href="#make_xh_obj"></a>
</h3>
<ul>
<li><p>In the following, replace <code>p1</code> with the first
parameter, <code>p2</code> with the second, and so on.</p></li>
<li><p>Unless you know what you’re doing, leave the “Ports for human /
host demography” unchanged.</p></li>
<li><p>If you don’t want to add ports for mass treatment, delete the
line with <code>mda</code> and <code>msat</code> and leave
<code>mda=FALSE</code> and <code>msat=FALSE</code> in
<code>skill_set_XH.newXname.</code> If you do want your module to have
that functionality, add the effects of mass treatment to the parameters
that define state transitions in <code>dXHdt</code> or
<code>Update_XHt</code> and set <code>mda=TRUE</code> and
<code>msat=TRUE</code> in the skill set.</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Make parameters for newXname human model, with defaults</span></span>
<span><span class="co">#' @param nStrata is the number of population strata</span></span>
<span><span class="co">#' @param options a [list] that could overwrite defaults</span></span>
<span><span class="co">#' @param p1 the first parameter </span></span>
<span><span class="co">#' @param p2 the second parameter </span></span>
<span><span class="co">#' @param p3 the third parameter </span></span>
<span><span class="co">#' @return a [list]</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">make_XH_obj_newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nStrata</span>, <span class="va">options</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         <span class="va">p1</span><span class="op">=</span><span class="fl">1</span>, <span class="va">p2</span><span class="op">=</span><span class="fl">2</span>, <span class="va">p3</span><span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">options</span>,<span class="op">{</span></span>
<span>    <span class="va">XH_obj</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">XH_obj</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"newXname"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Change this</span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/checkIt.html" class="external-link">checkIt</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/checkIt.html" class="external-link">checkIt</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/checkIt.html" class="external-link">checkIt</a></span><span class="op">(</span><span class="va">p3</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Don't change this</span></span>
<span>    <span class="co"># Ports for human / host demography </span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">D_matrix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nStrata</span><span class="op">)</span> </span>
<span>    <span class="va">births</span> <span class="op">=</span> <span class="st">"zero"</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span> <span class="op">=</span> <span class="va">births</span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">births</span> <span class="op">=</span> <span class="va">births</span> </span>
<span>    </span>
<span>    <span class="co"># Maybe delete this </span></span>
<span>    <span class="co"># Ports for mass treatment </span></span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">mda</span> <span class="op">=</span> <span class="va">F_zero</span> </span>
<span>    <span class="va">XH_obj</span><span class="op">$</span><span class="va">msat</span> <span class="op">=</span> <span class="va">F_zero</span> </span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">XH_obj</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="setup_xh_obj">setup_XH_obj<a class="anchor" aria-label="anchor" href="#setup_xh_obj"></a>
</h3>
<p>If you did a global search and replace on <code>newXname,</code> this
function will not need to be modified</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Setup XH_obj.newXname</span></span>
<span><span class="co">#' @description Implements [setup_XH_obj] for the newXname model</span></span>
<span><span class="co">#' @inheritParams ramp.xds::setup_XH_obj</span></span>
<span><span class="co">#' @return a [list] vector</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">setup_XH_obj.newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">newXname</span>, <span class="va">xds_obj</span>, <span class="va">i</span>, <span class="va">options</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu">make_XH_obj_newXname</span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">nStrata</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">options</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
</div>
<div class="section level2">
<h2 id="variables">Variables<a class="anchor" aria-label="anchor" href="#variables"></a>
</h2>
<div class="section level3">
<h3 id="setup_xh_ix">setup_XH_ix<a class="anchor" aria-label="anchor" href="#setup_xh_ix"></a>
</h3>
<p>In the following, each variable in your model gets its own pair of
lines. Replace <code>X1</code> in <code>X1_ix</code> with the first
variable name, <code>X2</code> in <code>X2_ix</code> with the second,
and add lines for each variable by copying and pasting and editing the
pair of lines. Be sure the replacement gets applied to all four
instances.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Add indices for human population to parameter list</span></span>
<span><span class="co">#' @description Implements [setup_XH_ix] for the newXname model.</span></span>
<span><span class="co">#' @inheritParams ramp.xds::setup_XH_ix</span></span>
<span><span class="co">#' @return none</span></span>
<span><span class="co">#' @importFrom utils tail</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">setup_XH_ix.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span>,<span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">X1_ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">max_ix</span><span class="op">+</span><span class="fl">1</span>, length.out<span class="op">=</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">nStrata</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">max_ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">X1_ix</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">X2_ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">max_ix</span><span class="op">+</span><span class="fl">1</span>, length.out<span class="op">=</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">nStrata</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">max_ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">X2_ix</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">...</span> </span>
<span>  </span>
<span>  <span class="va">xds_obj</span><span class="op">$</span><span class="va">max_ix</span> <span class="op">=</span> <span class="va">max_ix</span></span>
<span>  <span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X1_ix<span class="op">=</span><span class="va">X1_ix</span>, X2_ix<span class="op">=</span><span class="va">X2_ix</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get_xh_vars">get_XH_vars<a class="anchor" aria-label="anchor" href="#get_xh_vars"></a>
</h3>
<p>In the following, each variable in your model gets its own pair of
lines.</p>
<ul>
<li><p>Leave <code>H</code> as-is</p></li>
<li><p>Replace <code>X1</code> in <code>X1</code> and <code>X1_ix</code>
with the first variable name.</p></li>
<li><p>Replace <code>X2</code> in <code>X2</code> and <code>X2_ix</code>
with the second variable name.</p></li>
<li><p>Copy the form for every other variable</p></li>
<li><p>The variable <code>X0</code> is the class that gets newborns. If
you use it or if you want to have it available, compute it and add it to
the returned list.</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Return the variables as a list</span></span>
<span><span class="co">#' @description This method dispatches on the type of `xds_obj$XH_obj`</span></span>
<span><span class="co">#' @inheritParams ramp.xds::get_XH_vars</span></span>
<span><span class="co">#' @return a [list]</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">get_XH_vars.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ix</span>,<span class="op">{</span></span>
<span>      <span class="va">H</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">H_ix</span><span class="op">]</span></span>
<span>      <span class="va">X1</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">X1_ix</span><span class="op">]</span></span>
<span>      <span class="va">X2</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">X2_ix</span><span class="op">]</span></span>
<span>      <span class="va">...</span></span>
<span>      <span class="va">X0</span> <span class="op">=</span> <span class="va">H</span><span class="op">-</span><span class="va">X1</span><span class="op">-</span><span class="va">X2</span> </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>H<span class="op">=</span><span class="va">H</span>, X1<span class="op">=</span><span class="va">X1</span>, X2<span class="op">=</span><span class="va">X2</span>,<span class="va">...</span>,X0<span class="op">=</span><span class="va">X0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parse_xh_orbits">parse_XH_orbits<a class="anchor" aria-label="anchor" href="#parse_xh_orbits"></a>
</h3>
<p>In the following, each variable in your model gets its own pair of
lines.</p>
<ul>
<li><p>Leave <code>H</code> as-is</p></li>
<li><p>Replace <code>X1</code> in <code>X1</code> and <code>X1_ix</code>
with the first variable name.</p></li>
<li><p>Replace <code>X2</code> in <code>X2</code> and <code>X2_ix</code>
with the second variable name.</p></li>
<li><p>Copy the form for every other variable</p></li>
<li><p>The variable <code>X0</code> is the class that gets newborns. If
you use it or if you want to have it available, compute it and add it to
the returned list.</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title parse the output of deSolve and return variables for the newXname model</span></span>
<span><span class="co">#' @description Implements [parse_XH_orbits] for the newXname model</span></span>
<span><span class="co">#' @inheritParams ramp.xds::parse_XH_orbits</span></span>
<span><span class="co">#' @return a named list  </span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">parse_XH_orbits.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">outputs</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ix</span>,<span class="op">{</span></span>
<span>    <span class="va">H</span> <span class="op">&lt;-</span> <span class="va">outputs</span><span class="op">[</span>,<span class="va">H_ix</span><span class="op">]</span></span>
<span>    <span class="va">X1</span> <span class="op">&lt;-</span> <span class="va">outputs</span><span class="op">[</span>,<span class="va">X1_ix</span><span class="op">]</span></span>
<span>    <span class="va">X2</span> <span class="op">&lt;-</span> <span class="va">outputs</span><span class="op">[</span>,<span class="va">X2_ix</span><span class="op">]</span></span>
<span>    <span class="va">X0</span> <span class="op">&lt;-</span> <span class="va">H</span><span class="op">-</span><span class="va">X1</span><span class="op">-</span><span class="va">X2</span></span>
<span>    <span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>H<span class="op">=</span><span class="va">H</span>, X1<span class="op">=</span><span class="va">X1</span>, X2<span class="op">=</span><span class="va">X2</span>, X0<span class="op">=</span><span class="va">X0</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="initial-values">Initial Values<a class="anchor" aria-label="anchor" href="#initial-values"></a>
</h2>
<div class="section level3">
<h3 id="setup_xh_inits">setup_XH_inits<a class="anchor" aria-label="anchor" href="#setup_xh_inits"></a>
</h3>
<p>If you did the global search and replace, you won’t need to change
this function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Setup initial values for *newXname*</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @inheritParams ramp.xds::setup_XH_inits</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @return a **`ramp.xds`** object </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">setup_XH_inits.newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">H</span>, <span class="va">i</span>, <span class="va">options</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">inits</span> <span class="op">=</span> <span class="fu">make_XH_inits_newXname</span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">nStrata</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">H</span>, <span class="va">options</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make_xh_inits">make_XH_inits<a class="anchor" aria-label="anchor" href="#make_xh_inits"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Make initial values for the Xname human model, with defaults</span></span>
<span><span class="co">#' @param nStrata the number of strata in the model</span></span>
<span><span class="co">#' @param options a [list] to overwrite defaults</span></span>
<span><span class="co">#' @param X10 the initial value for X1 </span></span>
<span><span class="co">#' @param X20 the initial value for X1 </span></span>
<span><span class="co">#' @return a [list]</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">make_XH_inits_newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nStrata</span>, <span class="va">H</span>, <span class="va">options</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">X10</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">X20</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">options</span>,<span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">X10</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">X20</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/checkIt.html" class="external-link">checkIt</a></span><span class="op">(</span><span class="va">X10</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>  <span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/checkIt.html" class="external-link">checkIt</a></span><span class="op">(</span><span class="va">X20</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X1<span class="op">=</span><span class="va">X1</span>, X2<span class="op">=</span><span class="va">X2</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="change_xh_inits">change_XH_inits<a class="anchor" aria-label="anchor" href="#change_xh_inits"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Return the parameters as a list</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @inheritParams ramp.xds::change_XH_inits </span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @return an **`xds`** object</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">change_XH_inits.SIS</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">=</span><span class="fl">1</span>, <span class="va">options</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/get_XH_inits.html" class="external-link">get_XH_inits</a></span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">options</span>,<span class="op">{</span></span>
<span>    <span class="va">xds_obj</span> <span class="op">=</span> <span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/change_H.html" class="external-link">change_H</a></span><span class="op">(</span><span class="va">H</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span></span>
<span>    <span class="va">xds_obj</span><span class="op">$</span><span class="va">Xinits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X1</span> <span class="op">=</span> <span class="va">X1</span> </span>
<span>    <span class="va">xds_obj</span><span class="op">$</span><span class="va">Xinits</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">X2</span> <span class="op">=</span> <span class="va">X2</span> </span>
<span>    <span class="va">...</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="dynamical-terms">Dynamical Terms<a class="anchor" aria-label="anchor" href="#dynamical-terms"></a>
</h2>
<div class="section level3">
<h3 id="f_x">F_X<a class="anchor" aria-label="anchor" href="#f_x"></a>
</h3>
<p>In the following, replace … with a formula to compute the effective
density of infectious humans: it is population density by strata
weighted by the probability of transmitting.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Size of effective infectious human population</span></span>
<span><span class="co">#' @description Implements [F_X] for the SIS model.</span></span>
<span><span class="co">#' @inheritParams ramp.xds::F_X</span></span>
<span><span class="co">#' @return a [numeric] vector of length `nStrata`</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">F_X.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/get_XH_vars.html" class="external-link">get_XH_vars</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="op">{</span></span>
<span>      <span class="va">X</span> <span class="op">=</span> <span class="va">...</span>  </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="f_h">F_H<a class="anchor" aria-label="anchor" href="#f_h"></a>
</h3>
<p>If you did the global search and repace, and if you haven’t changed
the name of <code>H</code> then this won’t need to be changed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Size of effective infectious human population</span></span>
<span><span class="co">#' @description Implements [F_H] for the newXname model.</span></span>
<span><span class="co">#' @inheritParams ramp.xds::F_H</span></span>
<span><span class="co">#' @return a [numeric] vector of length `nStrata`</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">F_H.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://dd-harp.github.io/ramp.xds/reference/get_XH_vars.html" class="external-link">get_XH_vars</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span><span class="op">$</span><span class="va">H</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="f_infectivity">F_infectivity<a class="anchor" aria-label="anchor" href="#f_infectivity"></a>
</h3>
<p>If you use <code>b</code> for the probability of getting infected,
per infectious bite, don’t change anything.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Infection blocking pre-erythrocytic immunity</span></span>
<span><span class="co">#' @description Implements [F_infectivity] for the newXname model.</span></span>
<span><span class="co">#' @inheritParams ramp.xds::F_infectivity</span></span>
<span><span class="co">#' @return a [numeric] vector of length `nStrata`</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">F_infectivity.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="op">{</span> </span>
<span>    <span class="co">########################</span></span>
<span>    <span class="co"># retrieve or compute it </span></span>
<span>    <span class="co">########################</span></span>
<span>    <span class="va">b</span> <span class="op">=</span> <span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span></span>
<span>    <span class="co">########################</span></span>
<span>    <span class="co"># return it </span></span>
<span>    <span class="co">########################</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="other-outputs">Other Outputs<a class="anchor" aria-label="anchor" href="#other-outputs"></a>
</h2>
<p>To make <code>ramp.xds</code> easy to use, we provide some functions
that parse the outputs and compute some standard metrics.</p>
<div class="section level3">
<h3 id="f_prevalence">F_prevalence<a class="anchor" aria-label="anchor" href="#f_prevalence"></a>
</h3>
<p>Replace <code>X1/H</code> with the formula to compute prevalence.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Compute the true prevalence of infection / parasite rate</span></span>
<span><span class="co">#' @description Implements F_pr for the newXname model.</span></span>
<span><span class="co">#' @inheritParams F_pr</span></span>
<span><span class="co">#' @return a [numeric] vector of length `nStrata`</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">F_prevalence.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">XH_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">vars</span>, <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">XH_obj</span>,<span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">X1</span><span class="op">/</span><span class="va">H</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="htc">HTC<a class="anchor" aria-label="anchor" href="#htc"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @title Compute the HTC for the newXname model</span></span>
<span><span class="co">#' @description Implements [HTC] for the newXname model with demography.</span></span>
<span><span class="co">#' @inheritParams ramp.xds::HTC</span></span>
<span><span class="co">#' @return a [numeric] vector</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">HTC.newXname</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="co">#HTC &lt;- </span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">HTC</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="internal-consistency">Internal Consistency<a class="anchor" aria-label="anchor" href="#internal-consistency"></a>
</h2>
</div>
<div class="section level2">
<h2 id="optional-functions">Optional Functions<a class="anchor" aria-label="anchor" href="#optional-functions"></a>
</h2>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
</div>
<div class="section level3">
<h3 id="xds_lines_x">16. xds_lines_X<a class="anchor" aria-label="anchor" href="#xds_lines_x"></a>
</h3>
<div class="section level4">
<h4 id="xds_lines_x_sis">xds_lines_X_SIS<a class="anchor" aria-label="anchor" href="#xds_lines_x_sis"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Add lines for the density of infected individuals for the SIS model</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param XH a list with the outputs of parse_deout_X_SIS</span></span>
<span><span class="co">#' @param nStrata the number of population strata</span></span>
<span><span class="co">#' @param clrs a vector of colors</span></span>
<span><span class="co">#' @param llty an integer (or integers) to set the `lty` for plotting</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">xds_lines_X_SIS</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">XH</span>, <span class="va">nStrata</span>, <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>,<span class="st">"darkred"</span><span class="op">)</span>, <span class="va">llty</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">XH</span>,<span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">nStrata</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">S</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">I</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">nStrata</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">clrs</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">clrs</span>, <span class="fl">2</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">llty</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="va">llty</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">llty</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nStrata</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">S</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">I</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">2</span>,<span class="va">i</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="xds_lines_x_newxname">xds_lines_X_newXname<a class="anchor" aria-label="anchor" href="#xds_lines_x_newxname"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Add lines for the density of infected individuals for the newXname model</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param XH a list with the outputs of parse_deout_X_newXname</span></span>
<span><span class="co">#' @param nStrata the number of population strata</span></span>
<span><span class="co">#' @param clrs a vector of colors</span></span>
<span><span class="co">#' @param llty an integer (or integers) to set the `lty` for plotting</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">xds_lines_X_newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">XH</span>, <span class="va">nStrata</span>, <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>,<span class="st">"darkred"</span><span class="op">)</span>, <span class="va">llty</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">XH</span>,<span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">nStrata</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">S</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">I</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">nStrata</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">clrs</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">clrs</span>, <span class="fl">2</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">llty</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="va">llty</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">llty</span>, <span class="va">nStrata</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nStrata</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">S</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">1</span>,<span class="va">i</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">I</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, col<span class="op">=</span><span class="va">clrs</span><span class="op">[</span><span class="fl">2</span>,<span class="va">i</span><span class="op">]</span>, lty <span class="op">=</span> <span class="va">llty</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="xds_plot_x">17. xds_plot_X<a class="anchor" aria-label="anchor" href="#xds_plot_x"></a>
</h3>
<p>We provide a basic plotting function. The function
<code>xds_lines_X_*</code> does not have an <code>S3</code> version.
Instead, it is called by the <code>S3</code> function
<code>xds_plot_X</code></p>
<div class="section level4">
<h4 id="generic">Generic<a class="anchor" aria-label="anchor" href="#generic"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Basic plotting for epidemiological models</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param xds_obj a list that defines an `ramp.xds` model (*e.g.*,  generated by `xde_setup()`)</span></span>
<span><span class="co">#' @param i the host species index</span></span>
<span><span class="co">#' @param clrs a vector of colors</span></span>
<span><span class="co">#' @param llty an integer (or integers) to set the `lty` for plotting</span></span>
<span><span class="co">#' @param stable a logical: set to FALSE for `orbits` and TRUE for `stable_orbits`</span></span>
<span><span class="co">#' @param add_axes a logical: plot axes only if TRUE</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">xds_plot_X</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">=</span><span class="fl">1</span>, <span class="va">clrs</span><span class="op">=</span><span class="st">"black"</span>, <span class="va">llty</span><span class="op">=</span><span class="fl">1</span>, <span class="va">stable</span><span class="op">=</span><span class="cn">FALSE</span>, <span class="va">add_axes</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod</a></span><span class="op">(</span><span class="st">"xds_plot_X"</span>, <span class="va">xds_obj</span><span class="op">$</span><span class="va">XH_obj</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="xds_plot_x-sis">xds_plot_X.SIS<a class="anchor" aria-label="anchor" href="#xds_plot_x-sis"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Plot the density of infected individuals for the newXname model</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @inheritParams ramp.xds::xds_plot_X</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">xds_plot_X.SIS</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">=</span><span class="fl">1</span>, <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>,<span class="st">"darkred"</span><span class="op">)</span>, <span class="va">llty</span><span class="op">=</span><span class="fl">1</span>, <span class="va">stable</span><span class="op">=</span><span class="cn">FALSE</span>, <span class="va">add_axes</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">vars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">outputs</span>,<span class="kw">if</span><span class="op">(</span><span class="va">stable</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span><span class="va">stable_orbits</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="va">orbits</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">add_axes</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">vars</span><span class="op">$</span><span class="va">XH</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">0</span><span class="op">*</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              ylab <span class="op">=</span> <span class="st">"# Infected"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="fu">xds_lines_X_SIS</span><span class="op">(</span><span class="va">vars</span><span class="op">$</span><span class="va">XH</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">xds_obj</span><span class="op">$</span><span class="va">Hpar</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nStrata</span>, <span class="va">clrs</span>, <span class="va">llty</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="xds_plot_x-newxname">xds_plot_X.newXname<a class="anchor" aria-label="anchor" href="#xds_plot_x-newxname"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Plot the density of infected individuals for the newXname model</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @inheritParams ramp.xds::xds_plot_X</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">xds_plot_X.newXname</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xds_obj</span>, <span class="va">i</span><span class="op">=</span><span class="fl">1</span>, <span class="va">clrs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkblue"</span>,<span class="st">"darkred"</span><span class="op">)</span>, <span class="va">llty</span><span class="op">=</span><span class="fl">1</span>, <span class="va">stable</span><span class="op">=</span><span class="cn">FALSE</span>, <span class="va">add_axes</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">vars</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">xds_obj</span><span class="op">$</span><span class="va">outputs</span>,<span class="kw">if</span><span class="op">(</span><span class="va">stable</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span><span class="va">stable_orbits</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="va">orbits</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">add_axes</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">vars</span><span class="op">$</span><span class="va">XH</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">0</span><span class="op">*</span><span class="va">time</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              ylab <span class="op">=</span> <span class="st">"# Infected"</span>, xlab <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">xds_lines_X_newXname</span><span class="op">(</span><span class="va">vars</span><span class="op">$</span><span class="va">XH</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">xds_obj</span><span class="op">$</span><span class="va">Hpar</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nStrata</span>, <span class="va">clrs</span>, <span class="va">llty</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reusable-code">Reusable Code<a class="anchor" aria-label="anchor" href="#reusable-code"></a>
</h2>
<p><strong><code>ramp.xds</code></strong> has a modular design. The
modular design makes it possible to break down published models to serve
as dynamical components in new models for malaria, a kind of
plug-and-play functionality for two kinds of systems:</p>
<ul>
<li><p>systems of ordinary and delay differential equations models for
malaria and other mosquito-transmitted pathogens.</p></li>
<li><p>stochastic and deterministic discrete time systems for malaria
and other mosquito-transmitted pathogens.</p></li>
</ul>
<p>This package – <code>ramp.library</code> – is a collection of models
to implement a large number of dynamical model families and other
algorithms taken from the literature describing malaria and other
mosquito-transmitted pathogens (see Reiner, <em>et al.</em> 2013)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Those
models have been implemented here as code that has undergone rigorous
testing and that can be used to build models for simulation-based
analytics.</p>
<p>The mathematics supporting this framework were explained in <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010684" target="_blank" class="external-link">Spatial Dynamics of Malaria Transmission</a> <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>This vignette was written to help add new modules to
<code>ramp.library.</code></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Reiner RC Jr, Perkins TA, Barker CM, Niu T, Chaves LF,
Ellis AM, et al. A systematic review of mathematical models of
mosquito-borne pathogen transmission: 1970-2010. J R Soc Interface.
2013;10: 20120921.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Wu SL, Henry JM, Citron DT, Mbabazi Ssebuliba D,
Nakakawa Nsumba J, Sánchez C. HM, et al. (2023) Spatial dynamics of
malaria transmission. PLoS Comput Biol 19(6): e1010684. <a href="https://doi.org/10.1371/journal.pcbi.1010684" class="external-link uri">https://doi.org/10.1371/journal.pcbi.1010684</a><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David L. Smith, Juliet Nsumba Nakakawa, Doreen Mbabazi Ssebuliba.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
