<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Macdonald's Model • ramp.library</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Macdonald's Model">
<meta property="og:description" content="ramp.library">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.library</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Adding_Models.html">Adding Models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Adult
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MYZ-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/MYZ-How_To_Add_Model.html">How to add a new MYZ model</a>
    </li>
    <li>
      <a href="../articles/MYZ-macdonald.html">Macdonald's Model</a>
    </li>
    <li>
      <a href="../articles/MYZ-xde-RMG.html">A Behavioral State Model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Aquatic
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/L-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/L-How_To_Add_Model.html">How to add a new L model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Human / Host
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Malaria-Overview.html">Malaria Overview</a>
    </li>
    <li>
      <a href="../articles/Compartmental-Models.html">Compartmental Models</a>
    </li>
    <li>
      <a href="../articles/X-How_To_Add_Model.html">How to add a new X model</a>
    </li>
    <li>
      <a href="../articles/human_sip.html">SIP xde model</a>
    </li>
    <li>
      <a href="../articles/human_seis.html">SEIS model</a>
    </li>
    <li>
      <a href="../articles/X-garki.html">The Garki Model</a>
    </li>
    <li>
      <a href="../articles/X-xde-workhorse.html">Workhorse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.library/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Macdonald’s Model</h1>
            <h3 data-toc-skip class="subtitle">A Delay Differential
Equation for Adult Mosquito Infection Dynamics</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/HEAD/vignettes/MYZ-macdonald.Rmd" class="external-link"><code>vignettes/MYZ-macdonald.Rmd</code></a></small>
      <div class="hidden name"><code>MYZ-macdonald.Rmd</code></div>

    </div>

    
    
<p>The <code>macdonald</code> module was included in
<strong><code>ramp.xds</code></strong> for historical reasons:
Macdonald’s model for mosquito infection dynamics is a special case.
What I am calling <em>Macdonald’s Model</em> comes from three
publications in 1952-1953. In 1952, George Macdonald published <a href="https://pubmed.ncbi.nlm.nih.gov/14958825/" class="external-link"><em>The analysis of the
sporozoite rate</em></a><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Later that year, in <a href="https://pubmed.ncbi.nlm.nih.gov/12995455/" class="external-link"><em>The analysis of
equilibrium in malaria</em></a><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, Macdonald presented a formula for the
<em>basic reproduction rate</em> of malaria parasites, now often called
<span class="math inline">\(R_0\)</span> (pronounced R-naught).
Macdonald gives credit to his colleague Armitage for the mathematics.
Armitage’s paper, <a href="https://pubmed.ncbi.nlm.nih.gov/13113672/" class="external-link"><em>A note on the
epidemiology of malaria</em></a><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> would appear in 1953, but it was not
presented as a system of differential equations.</p>
<p>The module called <em><code>macdonald</code></em> was included in
<strong><code>ramp.library</code></strong> as an example of a module
that was <em>not</em> extensible. The model was formulated as a system
of delay diferential equations, and the formulation of the
<em>non-autonomous</em> model (<em>e.g.</em> with forcing due to weather
or vector control) requires some mathematics. This is, perhaps, why
compartment models are so commonly used. A fully extensible delay
differential equation model that extends Macdonald’s model is the
generalized, non-autonomous Ross-Macdonald module <code>GeRM.</code></p>
<p>In the following, we present a version of Macdonald’s model. Next, we
present an extension of Macdonald’s model that is extensible, published
by Joan Aron and Robert M. May in 1982. Finally, we present
<code>macdonald</code> as an <em>autonomous</em> spatial version of
Macdonald’s model.</p>
<div class="section level2">
<h2 id="macdonalds-model">Macdonald’s Model<a class="anchor" aria-label="anchor" href="#macdonalds-model"></a>
</h2>
<p>If Macdonald’s analysis were presented as a mathematical model, it
would almost certainly look something like the following. Consider a
simple system of differential equations the sporozoite rate has three
parameters and one term:</p>
<ul>
<li><p>the human blood feeding rate, <span class="math inline">\(a\)</span></p></li>
<li><p>the extrinsic incubation period, <span class="math inline">\(\tau\)</span></p></li>
<li><p>the mosquito death rate, <span class="math inline">\(g\)</span>;
or the probability of surviving one day, <span class="math inline">\(p=e^{-g}\)</span>, so <span class="math inline">\(g=-\ln p\)</span></p></li>
<li><p>the fraction of bites on humans that infect a mosquito, <span class="math inline">\(\kappa\)</span></p></li>
</ul>
<p>Let <span class="math inline">\(y\)</span> denote the fraction of
mosquitoes that are infected. The dynamics are given by: <span class="math display">\[\frac{dy}{dt} = a \kappa (1-y) - g y\]</span> Let
<span class="math inline">\(z\)</span> denote the fraction of mosquitoes
that are infectious. The model is a delay differential equation. Let
<span class="math inline">\(y_\tau\)</span> denote the value of <span class="math inline">\(y\)</span> at time <span class="math inline">\(t-\tau.\)</span> If the parameters and terms are
constant, then:<br><span class="math display">\[\frac{dz}{dt} = e^{-g\tau} a \kappa
(1-y_\tau) - g z\]</span> The model has a steady state for the fraction
infected: <span class="math display">\[\bar y = \frac{a \kappa} {a
\kappa + g}\]</span> The fraction infectious, also called the sporozoite
rate, is <span class="math display">\[\bar z = \frac{a \kappa} {a \kappa
+ g}e^{-g\tau}.\]</span> Macdonald used <span class="math inline">\(p\)</span> so his formula was: <span class="math display">\[\bar z = \frac{a \kappa} {a \kappa -\ln
p}e^{-p\tau}\]</span></p>
<p>To generate the formula for <span class="math inline">\(R_0,\)</span>
Macdonald introduces another variable and three additional
parameters:</p>
<ul>
<li><p>the ratio of mosquitoes to humans, <span class="math inline">\(m\)</span></p></li>
<li><p>the rate infections clear, <span class="math inline">\(r\)</span></p></li>
<li><p>the fraction of infectious bites that infect a human, <span class="math inline">\(b\)</span></p></li>
</ul>
<p>The fraction of infected and infectious humans, <span class="math inline">\(x,\)</span> is given by the equation:</p>
<p><span class="math display">\[\frac{dx}{dt} = m a z (1-y) - r
x\]</span> and the model assumes that <span class="math inline">\(\kappa
= x.\)</span> The formula for <span class="math inline">\(R_0\)</span>
in this system is: <span class="math display">\[R_0 = \frac{m b a^2}{gr}
e^{-g\tau} = \frac{m b a^2}{(-\ln p)r} e^{-p\tau}\]</span> In this form,
the model is difficult to use or extend.</p>
</div>
<div class="section level2">
<h2 id="aron-may">Aron &amp; May<a class="anchor" aria-label="anchor" href="#aron-may"></a>
</h2>
<p>The mosquito module in <strong><code>ramp.xds</code></strong> called
<code>macdonald</code> is based on a model first published in 1982 by
Joan Aron and Robert May<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. It includes state variables for total
mosquito density <span class="math inline">\(M\)</span>, infected
mosquito density <span class="math inline">\(Y\)</span>, and infectious
mosquito density <span class="math inline">\(Z\)</span>. In this model,
the blood feeding rate is split into an overall blood feeding rate,
<span class="math inline">\(f\)</span>, and the human fraction, <span class="math inline">\(q\)</span> such that <span class="math display">\[a=fq.\]</span> The Aron &amp; May’s equations
are: <span class="math display">\[\begin{array}{rl}
\frac{dM}{dt} &amp;= \Lambda(t) - g M \\
\frac{dY}{dt} &amp;= fq\kappa(M-Y) - g Y \\
\frac{dZ}{dt} &amp;= e^{-g\tau}fq\kappa_\tau(M_\tau-Y_\tau) - g Z \\
\end{array}\]</span></p>
</div>
<div class="section level2">
<h2 id="macdonald">
<code>macdonald</code><a class="anchor" aria-label="anchor" href="#macdonald"></a>
</h2>
<p>The module called <code>macdonald</code> has been extended beyond the
Aron &amp; May formulation to include spatial dynamics and parity. To
formulate the spatial model, a spatial domain is sub-divided into a set
of patches. Variable and parameter names do not change, but they can now
represent vectors of length <span class="math inline">\(n_p.\)</span> To
formulate the <em>demographic matrix,</em> denoted <span class="math inline">\(\Omega,\)</span> that describes mosquito
mortality, emigration, and other loss from the system. We let <span class="math inline">\(\sigma\)</span> denote the emigration rate and
<span class="math inline">\(\cal K\)</span> the mosquito dispersal
matrix. We also introduce a parameter, <span class="math inline">\(\mu\)</span> to model the fraction of mosquitoes
that are lost to emigration from each patch. <span class="math display">\[\Omega = \mbox{diag} \left(g\right) +
\left(\mbox{diag} \left(1-\mu\right)  - \cal K\right) \cdot \mbox{diag}
\left(\sigma\right)
\]</span></p>
<div class="section level3">
<h3 id="dynamics">Dynamics<a class="anchor" aria-label="anchor" href="#dynamics"></a>
</h3>
<p><span class="math display">\[\begin{array}{rl}
\dot{M} &amp; = \Lambda - \Omega\cdot M  \\
\dot{P} &amp; = \mbox{diag}(f) \cdot (M-P) -  \Omega \cdot P\\
\dot{Y} &amp; = \mbox{diag}(fq\kappa) \cdot (M-Y) - \Omega \cdot Y \\
\dot{Z} &amp; =
\dot{Z} = e^{-\Omega \tau} \cdot \mbox{diag}(fq\kappa_{t-\tau}) \cdot
(M_{t-\tau}-Y_{t-\tau}) - \Omega \cdot Z
\end{array}
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="ordinary-differential-equations">Ordinary Differential Equations<a class="anchor" aria-label="anchor" href="#ordinary-differential-equations"></a>
</h2>
<p>We note that the module <code>SI</code> provides a reasonably simple
approximating model that has no delay, but in computing <span class="math inline">\(fqZ,\)</span> it includes mortality and dispersal
that would have occurred during the EIP: <span class="math display">\[
Z = e^{-\Omega \tau} \cdot Y
\]</span> The implementation of <code>SI</code> is similar in spirit to
the simple model presented in Smith &amp; McKenzie (2004)<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>. in that mortality and
dispersal over the EIP is accounted for, but the time lag is not. While
transient dynamics of the ODE model will not equal the DDE model, they
have the same equilibrium values, and so for numerical work requiring
finding equilibrium points, the faster ODE model can be safely
substituted.</p>
</div>
<div class="section level2">
<h2 id="steady-states">Steady States<a class="anchor" aria-label="anchor" href="#steady-states"></a>
</h2>
<p>There are two logical ways to begin solving the non-trivial
equilibrium. The first assumes <span class="math inline">\(\Lambda\)</span> is known, which implies good
knowledge of mosquito ecology. The second assumes <span class="math inline">\(Z\)</span> is known, which implies knowledge of
the biting rate on the human population. We show both below.</p>
<div class="section level3">
<h3 id="starting-with-lambda">Starting with <span class="math inline">\(\Lambda\)</span><a class="anchor" aria-label="anchor" href="#starting-with-lambda"></a>
</h3>
<p>Given <span class="math inline">\(\Lambda\)</span> we can solve:</p>
<p><span class="math display">\[
M = \Omega^{-1} \cdot \Lambda
\]</span> Then given <span class="math inline">\(M\)</span> we set <span class="math inline">\(\dot{Y}\)</span> to zero and factor out <span class="math inline">\(Y\)</span> to get:</p>
<p><span class="math display">\[
Y = (\mbox{diag}(fq\kappa) + \Omega)^{-1} \cdot \mbox{diag}(fq\kappa)
\cdot M
\]</span> We set <span class="math inline">\(\dot{Z}\)</span> to zero to
get:</p>
<p><span class="math display">\[
Z = \Omega^{-1} \cdot e^{-\Omega \tau} \cdot \mbox{diag}(fq\kappa) \cdot
(M-Y)
\]</span></p>
<p>Because the dynamics of <span class="math inline">\(P\)</span> are
independent of the infection dynamics, we can solve it given <span class="math inline">\(M\)</span> as:</p>
<p><span class="math display">\[
P = (\Omega + \mbox{diag}(f))^{-1} \cdot \mbox{diag}(f) \cdot M
\]</span></p>
</div>
<div class="section level3">
<h3 id="starting-with-z">Starting with <span class="math inline">\(Z\)</span><a class="anchor" aria-label="anchor" href="#starting-with-z"></a>
</h3>
<p>It is more common that we start from an estimate of <span class="math inline">\(Z\)</span>, perhaps derived from an estimated EIR
(entomological inoculation rate). Given <span class="math inline">\(Z\)</span>, we can calculate the other state
variables and <span class="math inline">\(\Lambda\)</span>. For
numerical implementation, note that <span class="math inline">\((e^{-\Omega\tau})^{-1} =
e^{\Omega\tau}\)</span>.</p>
<p><span class="math display">\[
M-Y = \mbox{diag}(1/fq\kappa) \cdot (e^{-\Omega\tau})^{-1} \cdot \Omega
\cdot Z
\]</span></p>
<p><span class="math display">\[
Y = \Omega^{-1} \cdot \mbox{diag}(fq\kappa) \cdot (M-Y)
\]</span></p>
<p><span class="math display">\[
M = (M - Y) + Y
\]</span></p>
<p><span class="math display">\[
\Lambda = \Omega \cdot M
\]</span> We can use the same equation for <span class="math inline">\(P\)</span> as above.</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>The analysis of the sporozoite rate. Macdonald G (1952).
Trop Dis Bull 49(6):569-86.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The analysis of equilibrium in malaria. Macdonald G
(1952). Trop Dis Bull 49(9):813-29.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>A note on the epidemiology of malaria. Armitage P
(1953). Trop Dis Bull 50(10):890-2<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>The population dynamics of malaria. In <em>The
Population Dynamics of Infectious Diseases: Theory and
Applications,</em> R. M. Anderson, ed. (Springer US), pp. 139–179. <a href="https://link.springer.com/chapter/10.1007/978-1-4899-2901-3_5" target="_blank" class="external-link">online</a><a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Smith, D.L., Ellis McKenzie, F. Statics and dynamics of
malaria infection in Anopheles mosquitoes. Malar J 3, 13 (2004). <a href="https://doi.org/10.1186/1475-2875-3-13" target="_blank" class="external-link">online</a><a href="#fnref5" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David L. Smith, Juliet Nsumba Nakakawa, Doreen Mbabazi Ssebuliba.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
