<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Malaria Analytics with SIP-mav3 • ramp.library</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Malaria Analytics with SIP-mav3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.library</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Adding_Models.html">Adding Models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Adult

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MYZ-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/MYZ-How_To_Add_Model.html">How to add a new MYZ model</a>
    </li>
    <li>
      <a href="../articles/MYZ-macdonald.html">Macdonald's Model</a>
    </li>
    <li>
      <a href="../articles/MYZ-xde-RMG.html">A Behavioral State Model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Aquatic

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/L-Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/L-How_To_Add_Model.html">How to add a new L model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Human / Host

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Malaria-Overview.html">Malaria Overview</a>
    </li>
    <li>
      <a href="../articles/Compartmental-Models.html">Compartmental Models</a>
    </li>
    <li>
      <a href="../articles/X-How_To_Add_Model.html">How to add a new X model</a>
    </li>
    <li>
      <a href="../articles/human_sip.html">SIP xde model</a>
    </li>
    <li>
      <a href="../articles/human_seis.html">SEIS model</a>
    </li>
    <li>
      <a href="../articles/X-garki.html">The Garki Model</a>
    </li>
    <li>
      <a href="../articles/X-xde-workhorse.html">Workhorse</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.library/" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Malaria Analytics with SIP-mav3</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/main/vignettes/human_SIPtrack.Rmd" class="external-link"><code>vignettes/human_SIPtrack.Rmd</code></a></small>
      <div class="hidden name"><code>human_SIPtrack.Rmd</code></div>

    </div>

    
    
<p>A challenge for malaria is to capture the effects of a history of
exposure, which affects malaria infections and the development of
immunity. In other models, the issues arising have been handled in a
variety of ways, such as expanding the number of compartments in the
state space. Here, we handle these through development of variables that
describe a history of exposure.</p>
<p>The model is an <strong>SIP</strong> compartment model, and a set of
variables that track exposure. We call a <em>Generalized SIP</em> model.
The model has three states:</p>
<ul>
<li><p>infected
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>)</p></li>
<li><p>chemo-protected and not susceptible to infection
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>)</p></li>
<li><p>uninfected and not chemo-protected and thus susceptible to
infection
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>)</p></li>
</ul>
<p>There are at least two hybrid variables tracking infection:</p>
<ul>
<li><p>the mean MoI
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>)</p></li>
<li><p>the mean AoI
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)</p></li>
</ul>
<p>There is also a set of variables that track cumulative and recent
exposure, collectively called
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>v</mi><annotation encoding="application/x-tex">v</annotation></semantics></math>.
The generalized SIP model is thus a very general framework.</p>
<div class="section level3">
<h3 id="dynamics">Dynamics<a class="anchor" aria-label="anchor" href="#dynamics"></a>
</h3>
<p>We assume:</p>
<ul>
<li><p>the population is stratified by age, so each state variable is a
vector</p></li>
<li><p>aging is handled by a matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">D,</annotation></semantics></math>
that also handles age-specific mortality</p></li>
<li><p>untreated, simple infections clear at rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">r,</annotation></semantics></math>
and infections overall clear at the rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_r(r,m)</annotation></semantics></math></p></li>
</ul>
<p><strong>Treatment</strong> occurs in three ways:</p>
<ul>
<li><p>The background treatment rate includes treatment regardless of
epidemiological status. It is a function of age, exposure, and time
(<em>i.e.</em> for MDA)
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><msub><mi>F</mi><mi>ξ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi=F_\xi(a, t)</annotation></semantics></math></p></li>
<li><p>The treatment rate in infected humans, is related to moderate and
mild malaria (<em>i.e.</em> for MSAT)
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><msub><mi>F</mi><mi>σ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma=F_\sigma(a,w, t)</annotation></semantics></math></p></li>
<li><p>The treatment rate in response to malaria incidence: a fraction
thats presents with malaria and get treated:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><msub><mi>F</mi><mi>ρ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho= F_\rho(a,w)</annotation></semantics></math></p></li>
</ul>
<p>This one has three ways of treating:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mi>H</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>D</mi><mo>⋅</mo><mi>H</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mi>S</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>F</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.278em"></mspace><mi>I</mi><mo>+</mo><mi>η</mi><mi>P</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>+</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mo>−</mo><mi>D</mi><mo>⋅</mo><mi>S</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mi>I</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>F</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>ξ</mi><mo>+</mo><mi>σ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>I</mi><mo>−</mo><mi>D</mi><mo>⋅</mo><mi>I</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>d</mi><mi>P</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mi>ρ</mi><mo>+</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mo>−</mo><mi>P</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>σ</mi><mi>I</mi><mo>−</mo><mi>η</mi><mi>P</mi><mo>−</mo><mi>D</mi><mo>⋅</mo><mi>P</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rl}
\frac{\textstyle{dH}}{\textstyle{dt}} &amp;= B(H) - D\cdot H \\ 
\frac{\textstyle{dS}}{\textstyle{dt}} &amp;= B(H) + F_r(r, m) \;I +  \eta P - \left(h  + \xi\right) S - D \cdot S\\ 
\frac{\textstyle{dI}}{\textstyle{dt}} &amp;= h \left(1-\rho\right) S  - \left( F_r\left(r,m\right) + \xi + \sigma \right) I - D \cdot I\\ 
\frac{\textstyle{dP}}{\textstyle{dt}} &amp;= (h \rho + \xi)(H-P)  + \sigma I - \eta P - D \cdot P\\
\end{array}
</annotation></semantics></math> There is an implicit assumption about
superinfection here: everyone is getting reinfected, and this is a cause
of treatment.</p>
<p>(The implementation in <code>ramp.library</code> does not compute
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>S</mi><mi>/</mi><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">dS/dt</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is computed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>H</mi><mo>−</mo><mi>I</mi><mo>−</mo><mi>P</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">S=H-I-P.</annotation></semantics></math>)</p>
<p><strong>Mean MoI</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>m</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo>+</mo><mi>h</mi><mi>ρ</mi><mo>+</mo><mi>σ</mi><mo>+</mo><mi>ξ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">
\frac{\textstyle{dm}}{\textstyle{dt}}  = h(1-\rho) - \left(\eta + h \rho + \sigma + \xi \right) m
</annotation></semantics></math></p>
<p><strong>Mean AoI</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>α</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><mi>α</mi><mfrac><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">
\frac{\textstyle{d\alpha}}{\textstyle{dt}}  = 1- \alpha \frac{h(1-\rho)}{m} 
</annotation></semantics></math></p>
<p><strong>Tracking Exposure</strong></p>
<p>We let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
denote the FoI, and we a set of tracking variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.
One describes cumulative exposure:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>w</mi><mn>0</mn></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>h</mi></mrow><annotation encoding="application/x-tex">
\frac{\textstyle{dw_0}}{\textstyle{dt}}  = h 
</annotation></semantics></math> …and others describe recent exposure:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>w</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>h</mi><mo>−</mo><msub><mi>μ</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
\frac{\textstyle{dw_i}}{\textstyle{dt}}  = h - \mu_i w_i 
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="functional-responses">Functional Responses<a class="anchor" aria-label="anchor" href="#functional-responses"></a>
</h3>
<p>We need to write functions to translate the state space into measures
of prevalence by various diagnostic tests:</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="25%">
<col width="16%">
<col width="16%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th>Skill Set</th>
<th>Math Notation</th>
<th>Code</th>
<th>Depends</th>
<th>Control</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Force of Infection</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msub><mi>F</mi><mi>h</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h=F_h(E, b)</annotation></semantics></math></td>
<td><code>foi</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math></td>
<td></td>
</tr>
<tr class="even">
<td>Pre-Erythrocytic Immunity</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><msub><mi>F</mi><mi>b</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b = F_b(w)</annotation></semantics></math></td>
<td><code>F_b</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Infectious Density</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>F</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">X= F_c(\alpha, m) I</annotation></semantics></math></td>
<td><code>F_X</code></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Treatment: Incidence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><msub><mi>F</mi><mi>ρ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho = F_\rho(a,w)</annotation></semantics></math></td>
<td><code>rho</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Υ</mi><mi>h</mi></msub><mo>,</mo><msub><mi>Ξ</mi><mi>h</mi></msub><mo>,</mo><msub><mi>Φ</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">\Upsilon_h, \Xi_h, \Phi_h</annotation></semantics></math></td>
<td>MSAT</td>
</tr>
<tr class="odd">
<td>Treatment: Prevalence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><msub><mi>F</mi><mi>σ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma = F_\sigma(a,w,t)</annotation></semantics></math></td>
<td><code>sigma</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Υ</mi><mi>x</mi></msub><mo>,</mo><msub><mi>Ξ</mi><mi>x</mi></msub><mo>,</mo><msub><mi>Φ</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\Upsilon_x, \Xi_x, \Phi_x</annotation></semantics></math></td>
<td></td>
</tr>
<tr class="even">
<td>Treatment: Background</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><msub><mi>F</mi><mi>ξ</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\xi = F_\xi(a,t)</annotation></semantics></math></td>
<td><code>xi</code></td>
<td></td>
<td>MDA</td>
</tr>
<tr class="odd">
<td>True Prevalence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>I</mi><mi>/</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">x = I/H</annotation></semantics></math></td>
<td><code>pfpr</code></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Prevalence by LM</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>l</mi><mi>m</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>m</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x_{lm}= d_{lm}(\alpha, m) x</annotation></semantics></math></td>
<td><code>pfpr_lm</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Prevalence by PCR</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>p</mi><mi>c</mi><mi>r</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>p</mi><mi>c</mi><mi>r</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x_{pcr} = d_{pcr}(\alpha, m)x</annotation></semantics></math></td>
<td><code>pfpr_pcr</code></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Prevalence by RDT</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>r</mi><mi>d</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>d</mi><mrow><mi>r</mi><mi>d</mi><mi>t</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x_{rdt}= d_{rdt}(\alpha, m)x</annotation></semantics></math></td>
<td><code>pfpr_rdt</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Severe Malaria Incidence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Υ</mi><mi>h</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Υ</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Upsilon_h(h, w) + \Upsilon_x(x,w)</annotation></semantics></math></td>
<td><code>pfi_severe</code></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Moderate Malaria Incidence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ξ</mi><mi>h</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Ξ</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Xi_h(h, w) + \Xi_x(x,w)</annotation></semantics></math></td>
<td><code>pfi_moderate</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Mild Malaria Incidence</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mi>h</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi_h(h, w) + \Phi(x, w)</annotation></semantics></math></td>
<td><code>pfi_mild</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="prevalence">Prevalence<a class="anchor" aria-label="anchor" href="#prevalence"></a>
</h4>
<ul>
<li><p>True prevalence is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>/</mi><mi>H</mi></mrow><annotation encoding="application/x-tex">I/H</annotation></semantics></math></p></li>
<li><p>We assume the probability of testing positive is a function of
the mean MoI and the mean AoI. We develop tracking variables</p></li>
</ul>
<p>We have a picture like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">400</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">test_pos</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">aoi</span>, <span class="va">mx</span><span class="op">=</span><span class="fl">.95</span>, <span class="va">rt</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">mx</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">rt</span><span class="op">*</span><span class="op">(</span><span class="va">aoi</span><span class="op">-</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">test_pos</span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="st">" Age of Infection"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">xi</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, <span class="st">" Test Positivity"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">test_pos</span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">test_pos</span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">.7</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">80</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>If the AoI has a distribution in the population with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\alpha,</annotation></semantics></math>
and MoI
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">m,</annotation></semantics></math>
then average test positivity will be approximately:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
1 - e^{\xi(\alpha)m}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pr_by_aoi</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">aoi</span>, <span class="va">m</span>, <span class="va">mx</span><span class="op">=</span><span class="fl">0.95</span>, <span class="va">rt</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">xi</span> <span class="op">=</span> <span class="fu">test_pos</span><span class="op">(</span><span class="va">aoi</span>, <span class="va">mx</span>, <span class="va">rt</span><span class="op">)</span>  </span>
<span>  <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">xi</span><span class="op">*</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">pr_by_aoi</span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">1</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">90</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">bar</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, <span class="st">" Mean AoI"</span><span class="op">)</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">x</span><span class="op">(</span><span class="fu">bar</span> <span class="op">(</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span>, <span class="st">" Apparent PR"</span><span class="op">)</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">400</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">pr_by_aoi</span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">2</span>,  <span class="fl">.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">aoi</span>, <span class="fu">pr_by_aoi</span><span class="op">(</span><span class="va">aoi</span>, <span class="fl">4</span>, <span class="fl">.8</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-4-1.png" width="768"><strong>To Do:</strong> Draw this picture with a sharkfin function and
not an exponential.</p>
</div>
<div class="section level4">
<h4 id="infectiousness">Infectiousness<a class="anchor" aria-label="anchor" href="#infectiousness"></a>
</h4>
<p>Infectiousness is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">c(w) I</annotation></semantics></math></p>
<p>We follow the same idea as PR, but with a different lag.</p>
</div>
<div class="section level4">
<h4 id="disease-incidence">Disease Incidence<a class="anchor" aria-label="anchor" href="#disease-incidence"></a>
</h4>
<p>In these models, we have models for <em>malaria</em> and</p>
<ul>
<li><p>The probability of severe disease, per infection, defined as
malaria infection accompanied by one or more danger signs.</p></li>
<li><p>The probability of severe malaria anemia, per infection, defined
as malaria infection accompanied by one or more danger signs.</p></li>
<li><p>The probability of moderate disease, per infection, defined as
malaria infection and objective fever</p></li>
<li><p>The probability of mild disease, per infection, defined as
malaria infection and subjective fever</p></li>
</ul>
<p><strong>Severe Malaria</strong></p>
<p>We assume that severe malaria is related to recent exposure. We note
that exposure to malaria tends to increase with age, and it has been
proposed that the risk of severe malaria is reduce by exposure.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>w</mi><mi>ζ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
h e^{-w \zeta}
</annotation></semantics></math></p>
<p>in its simplest form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><msup><mi>e</mi><mrow><mo>−</mo><mi>h</mi><mi>a</mi><mi>ζ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
h e^{-h a \zeta}
</annotation></semantics></math><strong>Age and Exposure</strong></p>
<p>We note that exposure to malaria is age-dependent.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">foi_age</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span><span class="op">=</span><span class="fl">1</span>, <span class="va">shft</span><span class="op">=</span><span class="fl">30</span>, <span class="va">A</span><span class="op">=</span><span class="fl">1.5</span>, <span class="va">B</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">aa</span> <span class="op">=</span> <span class="op">(</span><span class="va">a</span><span class="op">+</span><span class="va">shft</span><span class="op">)</span><span class="op">/</span><span class="fl">365</span></span>
<span>  <span class="va">foi</span><span class="op">*</span><span class="va">A</span><span class="op">*</span><span class="va">aa</span><span class="op">/</span><span class="op">(</span><span class="va">B</span><span class="op">+</span><span class="va">aa</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">age</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">*</span><span class="fl">365</span>, by<span class="op">=</span><span class="fl">365</span><span class="op">/</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">foi_age</span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1.3</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Age (in Years)"</span>, ylab <span class="op">=</span> <span class="st">"FoI by Age"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>The model implies that cumulative exposure is concave up:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cum_exposure</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">365</span>, <span class="va">shft</span><span class="op">=</span><span class="fl">30</span>, <span class="va">A</span><span class="op">=</span><span class="fl">1.5</span>, <span class="va">B</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">fa</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span>, <span class="va">shft</span>, <span class="va">A</span>, <span class="va">B</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">foi_age</span>, <span class="fl">0</span>, <span class="va">a</span>, foi<span class="op">=</span><span class="va">foi</span>, shft<span class="op">=</span><span class="va">shft</span>, A<span class="op">=</span><span class="va">A</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">fa</span>, foi<span class="op">=</span><span class="va">foi</span>, shft<span class="op">=</span><span class="va">shft</span>, A<span class="op">=</span><span class="va">A</span>,B<span class="op">=</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_exposure</span><span class="op">(</span><span class="va">age</span>, foi <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Age (in Years)"</span>, ylab <span class="op">=</span> <span class="st">"Cumulative Exposure"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_exposure</span><span class="op">(</span><span class="va">age</span>, foi <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_exposure</span><span class="op">(</span><span class="va">age</span>, foi <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">incidence</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span><span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">365</span>, <span class="va">z</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">10</span>, <span class="va">N</span><span class="op">=</span><span class="fl">100</span>, <span class="va">shft</span><span class="op">=</span><span class="fl">30</span>, <span class="va">A</span><span class="op">=</span><span class="fl">1.5</span>, <span class="va">B</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">cum_exposure</span>, foi<span class="op">=</span><span class="va">foi</span>, shft<span class="op">=</span><span class="va">shft</span>, A<span class="op">=</span><span class="va">A</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span></span>
<span>  <span class="fu">foi_age</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span><span class="op">)</span><span class="op">*</span><span class="va">z</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">w</span><span class="op">*</span><span class="va">z</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base</span> <span class="op">=</span> <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">30</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">30</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Age (in Years)"</span>, ylab <span class="op">=</span> <span class="st">"Incidence"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">base</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">10</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cum_incidence</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span><span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">365</span>, <span class="va">z</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">10</span>, <span class="va">N</span><span class="op">=</span><span class="fl">100</span>, <span class="va">shft</span><span class="op">=</span><span class="fl">30</span>, <span class="va">A</span><span class="op">=</span><span class="fl">1.5</span>, <span class="va">B</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ci</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">foi</span>, <span class="va">z</span>, <span class="va">N</span>, <span class="va">shft</span>, <span class="va">A</span>, <span class="va">B</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">incidence</span>, <span class="fl">0</span>, <span class="va">a</span>, foi<span class="op">=</span><span class="va">foi</span>, z<span class="op">=</span><span class="va">z</span>, shft<span class="op">=</span><span class="va">shft</span>, A<span class="op">=</span><span class="va">A</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">ci</span>, foi<span class="op">=</span><span class="va">foi</span>, z<span class="op">=</span><span class="va">z</span>, shft<span class="op">=</span><span class="va">shft</span>, A<span class="op">=</span><span class="va">A</span>, B<span class="op">=</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">base</span> <span class="op">=</span> <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">10</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">30</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Age (in Years)"</span>, ylab <span class="op">=</span> <span class="st">"Incidence"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">base</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">10</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">3</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">age</span><span class="op">/</span><span class="fl">365</span>, <span class="fu">cum_incidence</span><span class="op">(</span><span class="va">age</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span></code></pre></div>
<p><img src="human_SIPtrack_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p><strong>Moderate Malaria</strong></p>
<p>We assume that severe malaria is related to recent exposure and
chronic infection</p>
<p><strong>Mild Malaria</strong></p>
<p>We assume that severe malaria is related to recent exposure and
chronic infection</p>
</div>
<div class="section level4">
<h4 id="treatment">Treatment<a class="anchor" aria-label="anchor" href="#treatment"></a>
</h4>
</div>
<div class="section level4">
<h4 id="clinical">Clinical<a class="anchor" aria-label="anchor" href="#clinical"></a>
</h4>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/ramp.xds/" class="external-link">ramp.xds</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/ramp.xds/" class="external-link">ramp.library</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David L. Smith, Juliet Nsumba Nakakawa, Doreen Mbabazi Ssebuliba.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
